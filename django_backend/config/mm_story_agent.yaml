# ==================== 全局配置 ====================
# 模型配置文件路径
models_config: configs/models.yaml

# 故事输出目录
story_dir: &story_dir generated_stories/example


# ==================== 故事生成 ====================
story_writer:
    tool: qa_outline_story_writer
    model: qwen3-max  # 使用的LLM模型（从models.yaml中选择）
    cfg:
        max_conv_turns: 3
        num_outline: 4
        temperature: 0.5
        max_pages: 10  # 最大页面数（用于测试）
    params:
        story_topic: "Magnet Mania - Introduction to magnets and how they work."
        main_role: "(no role specified)"
        scene: "(no scene specified)"


# ==================== 文本切分 ====================
text_split:
    params:
        max_chars: 100
        # Post-merge thresholds to avoid overly short segments
        min_chars_per_segment: 15
        min_words_per_segment: 3

# ==================== 语音合成 ====================
speech_generation:
    tool: speech_generation
    model: kokoro  # 使用的TTS模型（从models.yaml中选择）
    # 可选模型: cosyvoice, kokoro, speecht5, neutt_air
    cfg:
        # 模型特定参数会从models.yaml自动加载
        # 也可以在这里覆盖默认参数
        sample_rate: 24000
        lang_code: "a"  # kokoro特定参数
    params:
        voice: "af_heart"


# ==================== 图像生成 ====================
image_generation:
    tool: story_diffusion_t2i
    model: wanx_v1  # 使用的图像生成模型（从models.yaml中选择）
    # 可选模型: wanx_v1, dalle_3, dalle_2, sdxl, sdxl_replicate
    llm_model: qwen3-max  # 用于生成图像提示词的LLM模型
    cfg:
        num_turns: 3  # 提示词优化轮数
        height: &image_height 720
        width: &image_width 1280
    params:
        seed: 112536
        style_name: "Japanese Anime"
        # 可选风格: '(No style)', 'Japanese Anime', 'Digital/Oil Painting',
        # 'Pixar/Disney Character', 'Photographic', 'Comic book', 'Line art',
        # 'Black and White Film Noir', 'Isometric Rooms', 'Storybook'


# ==================== 文本转视频（Runway） ====================
t2v_generation:
    tool: runway_t2v
    model: runway_veo3.1
    cfg: {}
    params:
        # 可被运行时覆盖
        width: 1280
        height: 720
        fps: 24
        duration: 8           # 秒
        use_mock: false       # 开发阶段默认 true 生成占位视频；生产可改为 false

# ==================== 视频合成 ====================
video_compose:
    tool: slideshow_video_compose
    cfg:
        {}
    params:
        enable_crossfade: true
        crossfade: 0.25
        enable_audio_crossfade: false # 关键：音频不做淡化/叠加
        # --- New effects (enabled by default; tune values as needed) ---
        enable_fade: true
        fade_mode: ends  # all|in_only|out_only|first_last(=ends)|none
        fade_in: 0.2
        fade_out: 0.25

        enable_ken_burns: false
        kb_zoom_start: 0.8
        kb_zoom_end: 1.1
        kb_direction: center  # lr|rl|tb|bt|center
        # --- End effects ---
        fps: 24
        audio_sample_rate: 44100
        audio_codec: aac
        caption:
            font: resource/font/FiraCode-Regular.ttf
            # bg_color: LightGrey
            fontsize: 24
            color: white
            # stroke_color: white
            # stroke_width: 0.5
            workers: 4  # 并行字幕渲染线程数
            enable_captions: true  # 启用字幕（默认）
        bgm_path: "resource/bgm/Summer.flac"
        bgm_volume: 0.25  # Optional volume multiplier (0-1). Default 0.25 when mixing


# ==================== 可选：音乐生成 ====================
# music_generation:
#     tool: musicgen_t2m
#     model: musicgen  # 使用的音乐生成模型
#     cfg:
#         duration: 30
#     params:
#         prompt: "peaceful background music for children's story"


# ==================== 可选：音效生成 ====================
# sound_generation:
#     tool: audioldm2_t2a
#     model: audioldm2  # 使用的音效生成模型
#     cfg:
#         num_inference_steps: 200
#     params:
#         prompts: ["birds chirping", "door opening"]


# ==================== 可选：FreeSound检索 ====================
# freesound_sfx:
#     tool: freesound_sfx_retrieval
#     model: freesound_sfx
#     cfg:
#         max_results: 5
#     params:
#         queries: ["footsteps", "wind blowing"]
